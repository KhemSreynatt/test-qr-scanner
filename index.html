<!DOCTYPE html>
<html>

<head>
    <title>Simple QR Scanner</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>

<body>
    <div id="result">Tap the button to scan QR code</div>
    <div id="debug"></div>
    <script>
        let tg = window.Telegram.WebApp;

        function log(message) {
            console.log(message);
            document.getElementById('debug').innerHTML += message + '<br>';
        }

        function openQRScanner() {
            log('Opening QR Scanner...');
            tg.showScanQrPopup({
                text: "Scan any QR code"
            }, function (qrCode) {
                log('Scan completed');
                if (qrCode) {
                    log('Raw QR data: ' + qrCode);
                    document.getElementById('result').textContent = "Scanned: " + qrCode;
                } else {
                    log('No QR code scanned');
                    document.getElementById('result').textContent = "Scanning cancelled or failed";
                }
            });
        }

        tg.expand();
        tg.MainButton.text = "Scan QR Code";
        tg.MainButton.onClick(openQRScanner);
        tg.MainButton.show();

        log('TMA initialized');
    </script>
</body>

</html>