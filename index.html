<!DOCTYPE html>
<html>

<head>
    <title>QR Scanner Debug</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>

<body>
    <div id="debug">Debug info will appear here</div>
    <script>
        let tg = window.Telegram.WebApp;

        function log(message) {
            console.log(message);
            document.getElementById('debug').innerHTML += message + '<br>';
        }

        function openQRScanner() {
            log('Attempting to open QR scanner...');

            if (typeof tg.showScanQrPopup !== 'function') {
                log('ERROR: showScanQrPopup is not a function');
                return;
            }

            tg.showScanQrPopup({
                text: "Scan a QR code"
            }, function (qrCode) {
                log('Scan callback triggered');
                if (qrCode) {
                    log('Scanned QR code: ' + qrCode);
                } else {
                    log('No QR code scanned or scanning cancelled');
                }
            });
        }

        tg.expand();
        tg.MainButton.text = "Scan QR Code";
        tg.MainButton.onClick(openQRScanner);
        tg.MainButton.show();

        log('TMA initialized. Telegram WebApp version: ' + tg.version);
    </script>
</body>

</html>